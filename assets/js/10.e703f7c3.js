(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{598:function(t,s,a){t.exports=a.p+"assets/img/package_transfer.86619f76.png"},599:function(t,s,a){t.exports=a.p+"assets/img/iptables_match.f0b17a5c.png"},600:function(t,s,a){t.exports=a.p+"assets/img/iptables_rules.a2d2d206.jpg"},601:function(t,s,a){t.exports=a.p+"assets/img/iptables_firewalld.30a81743.png"},704:function(t,s,a){"use strict";a.r(s);var n=a(11),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,n=t._self._c||s;return n("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[n("h2",{attrs:{id:"netfilter"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#netfilter"}},[t._v("#")]),t._v(" Netfilter")]),t._v(" "),n("p",[t._v("netfilter 是 Linux 2.4 内核引入的全新的包过滤引擎，由一些数据包过滤表组成，这些表包含内核用来控制信息包过滤的规则集。"),n("code",[t._v("iptabes")]),t._v(" 等都是在用户空间修改过滤表规则的便捷工具。")]),t._v(" "),n("p",[t._v("netfilter 在数据包必须经过且可以读取规则的位置，共设有 5 个控制关卡。这五个关卡处的检查规则分别放在 5 个规则链(钩子函数)中, "),n("strong",[t._v("也就是说 5 条链对应着数据包传输路径中的 5 个控制关卡，链中的规则会在对应的关卡检查和处理")]),t._v("。任何一个数据包，只要经过本机，必须经过 5 个链中的某个或某几个。")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("PREROUTING")]),t._v(": 数据包刚进入网络接口之后，路由之前")]),t._v(" "),n("li",[n("strong",[t._v("INPUT")]),t._v(": 数据包从内核进入用户空间")]),t._v(" "),n("li",[n("strong",[t._v("FORWARD")]),t._v(": 在内核空间中，从一个网络接口进入，到另一个网络接口去。转发过滤")]),t._v(" "),n("li",[n("strong",[t._v("OUTPUT")]),t._v(": 数据包从用户空间留到内核空间")]),t._v(" "),n("li",[n("strong",[t._v("POSTROUTING")]),t._v(": 路由后，数据包离开网络接口前")])]),t._v(" "),n("p",[t._v("链其实就是包含众多规则的检查清单，每一条链中包含很多规则。当一个数据包到达一个链时，系统就会从链中第一条规则开始检查，看该数据包是否满足规则所定义的条件。如果满足，系统就会根据该条规则所定义的方法处理该数据包，否则就继续检查下一条规则，如果该数据包不符合链中任何一条规则，系统就会根据该链预先定义的默认策略来处理数据包。")]),t._v(" "),n("h2",{attrs:{id:"数据包的传输过程"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#数据包的传输过程"}},[t._v("#")]),t._v(" 数据包的传输过程")]),t._v(" "),n("ul",[n("li",[t._v("当一个数据包进入网卡时，它首先进入 "),n("code",[t._v("PREROUTING")]),t._v(" 链，内核根据数据包目的 IP 判断是否需要转送出去")]),t._v(" "),n("li",[t._v("如果数据包就是进入本机的，它就会沿着图向下移动，到达 "),n("code",[t._v("INPUT")]),t._v(" 链。数据包到了 "),n("code",[t._v("INPUT")]),t._v(" 链后，任何进程都会收到它。本机上运行的程序可以发送数据包，这些数据包会经过 "),n("code",[t._v("OUPUT")]),t._v(" 链，然后到达 "),n("code",[t._v("POSTROUTING")]),t._v(" 链输出")]),t._v(" "),n("li",[t._v("如果数据包是要转发出去的，且内核允许转发，数据包就会如图琐事向右移动，经过 "),n("code",[t._v("FORWARD")]),t._v(" 链，然后到达 "),n("code",[t._v("POSTROUTING")]),t._v(" 链输出。")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(598),alt:"数据包传输"}})]),t._v(" "),n("p",[t._v("可以看出，刚从网络接口进入的数据包尚未进行路由决策，还不知道数据要走向哪里，所有进出口没办法实现数据过滤，需要在内核空间设置转发关卡、进入用户空间关卡和开用户空间关卡。")]),t._v(" "),n("h1",{attrs:{id:"iptables"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#iptables"}},[t._v("#")]),t._v(" iptables")]),t._v(" "),n("p",[t._v("iptables 是用来管理防火墙的的工具，属于静态防火墙，我们通过 iptables 将过滤规则写入内核，然后 Netfilter 再根据规则进行过滤数据包。所以实际上 iptables 是通过调用 Netfilter 来进行防火墙管理的，它本身不具备过滤数据包的功能。iptables 程序位于 "),n("code",[t._v("/sbin/iptables")]),t._v("，配置文件位于 "),n("code",[t._v("/etc/sysconfig/iptables")])]),t._v(" "),n("p",[t._v("iptables 中也有和 Netfilter 中一模一样的5种规则链，还多了 4 个规则表。规则表的作用是容纳各种规则链。规则表的划分依据是防火墙规则的作用。规则表之间的匹配顺序: "),n("code",[t._v("raw --\x3e mangle --\x3e nat --\x3e filter")]),t._v("。")]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("raw")]),t._v(": 快速通道功能。只涉及 "),n("code",[t._v("PREROUTING、OUTPUT")]),t._v(" 两条链, 为了提高效率，优先级最高，符合 raw 表规则的数据包会跳过一些检查")]),t._v(" "),n("li",[n("strong",[t._v("mangle")]),t._v(": 数据包修改功能。每条链上都可以做修改操作，修改报元数据，做防火墙标记等")]),t._v(" "),n("li",[n("strong",[t._v("nat")]),t._v(": 地址转换功能。nat 转换只涉及 "),n("code",[t._v("PREROUTING、OUTPUT、POSTROUTING")]),t._v(" 三条链，可通过转发让局域网机器连接互联网")]),t._v(" "),n("li",[n("strong",[t._v("filter")]),t._v(": 数据包过滤功能。只涉及 "),n("code",[t._v("INPUT、FORWARD、OUTPUT")]),t._v(" 三条链，是 iptables 命令默认操纵的表")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(599),alt:"匹配流程示意图"}})]),t._v(" "),n("h2",{attrs:{id:"iptables基本语法"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#iptables基本语法"}},[t._v("#")]),t._v(" iptables基本语法")]),t._v(" "),n("blockquote",[n("p",[t._v("数据包常见控制类型")])]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("ACCEPT")]),t._v(": 允许通过")]),t._v(" "),n("li",[n("strong",[t._v("DROP")]),t._v(": 直接丢弃，不给出任何回应")]),t._v(" "),n("li",[n("strong",[t._v("REJECT")]),t._v(": 拒绝通过，必要时会给出提示")]),t._v(" "),n("li",[n("strong",[t._v("LOG")]),t._v(": 记录日志信息，然后传给下一条规则继续匹配")])]),t._v(" "),n("blockquote",[n("p",[t._v("语法构成")])]),t._v(" "),n("p",[n("code",[t._v("iptables [-t 表名] 选项 链名 条件 [-j 控制类型]")])]),t._v(" "),n("ul",[n("li",[t._v("不指定链名时，默认指定表内的所有链")]),t._v(" "),n("li",[t._v("除非设置链的默认策略，否则必须指定匹配条件")]),t._v(" "),n("li",[t._v("选项、链名、控制类型使用大写字母，其余均为小写")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(600),alt:"iptables语法构成"}})]),t._v(" "),n("blockquote",[n("p",[t._v("规则的匹配条件")])]),t._v(" "),n("p",[n("strong",[t._v("通用匹配")]),t._v("：可直接使用，不依赖于其他条件或扩展。包括网络协议、ip地址、网络接口等")]),t._v(" "),n("ul",[n("li",[t._v("协议匹配：-p  协议名               "),n("code",[t._v("iptables -A INPUT -p icmp -j DROP")])]),t._v(" "),n("li",[t._v("地址匹配：-s 源地址 、-d 目的地址    "),n("code",[t._v("iptables -A INPUT -s 192.168.10.0/24 -j DROP")])]),t._v(" "),n("li",[t._v("接口匹配：-i 入站网卡 、-o 出站网卡  "),n("code",[t._v("iptables -A INPUT -i eth0 -p icmp -j DROP")])])]),t._v(" "),n("p",[n("strong",[t._v("隐含匹配")]),t._v("：要求以特定的协议匹配作为前提，包括端口、TCP标记、ICMP类型等条件")]),t._v(" "),n("ul",[n("li",[n("p",[t._v("端口匹配：--sport 源端口 、--dport 目的端口   "),n("code",[t._v("iptables -A INPUT -p tcp --dprot 20:21 -j ACCEPT")])])]),t._v(" "),n("li",[n("p",[t._v("TCP标记匹配：--tcp-flags 检查范围 被设置的标记")])]),t._v(" "),n("li",[n("p",[t._v("ICMP类型匹配：--icmp-type ICMP类型\n     \n"),n("strong",[t._v("显式匹配")]),t._v('：要求以 " -m  扩展模块" 的形式明确指出类型，包括多端口、MAC地址、IP范围、数据包状态等')])]),t._v(" "),n("li",[n("p",[t._v("多端口匹配：-m multiport --sport 源端口列表  -m multiport --dport 目的端口列表  "),n("code",[t._v("iptables -A INPUT  -p tcp -m multiport --dport 25,80,110,143 -j ACCEPT")])])]),t._v(" "),n("li",[n("p",[t._v("IP范围匹配：-m iprange --src-range IP范围                                    "),n("code",[t._v("iptables -A FORWARD -p tcp -m iprange --src-range 192.168.4.21-192.168.4.28 -j ACCEPT")])])]),t._v(" "),n("li",[n("p",[t._v("MAC地址匹配：-m mac --mac-source  MAC地址                                    "),n("code",[t._v("iptables -A INPUT -m mac --mac-source 00:0c:29:c0:55:3f -j DROP")])])]),t._v(" "),n("li",[n("p",[t._v("状态匹配: -m state --state 连接状态")])])]),t._v(" "),n("blockquote",[n("p",[t._v("添加新的规则")])]),t._v(" "),n("ul",[n("li",[n("code",[t._v("iptables -t filter -A INPUT -p tcp -j ACCEPT")]),t._v("    在filter表的INPUT链中加入一条允许所有tcp协议的规则")]),t._v(" "),n("li",[n("code",[t._v("iptables -A INPUT -p tcp -j ACCEPT")]),t._v("             未加表名时，默认是filter表，所以和上面的语句一个意思")]),t._v(" "),n("li",[n("code",[t._v("iptables -I INPUT -p udp -j ACCEPT")]),t._v("              在filter表的INPUT链中的开头加一条允许所有udp协议的规则")]),t._v(" "),n("li",[n("code",[t._v("iptables -I INPUT 3 -p icmp -j ACCEPT")]),t._v("           在filter表中的INPUT链中的第3条加入一条允许所有icmp协议的规则")])]),t._v(" "),n("blockquote",[n("p",[t._v("删除，清空规则(暂时，重启失效)")])]),t._v(" "),n("ul",[n("li",[n("code",[t._v("iptables -D INPUT 3")]),t._v("          清除filter表中的INPUT链中的第3条规则")]),t._v(" "),n("li",[n("code",[t._v("iptables -t raw -F")]),t._v("           清除raw 表中的所有规则")]),t._v(" "),n("li",[n("code",[t._v("iptables -F")]),t._v("                  清除filter表中的规则，重启服务后恢复")])]),t._v(" "),n("blockquote",[n("p",[t._v("查看规则列表")])]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("-L：列出所有的规则条目"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("默认查看的是filter表"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n-n：以数字形式显示地址、端口等信息"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("地址用数字表示"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n-v：以更详细的方式显示规则信息"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("显示比特流，发包的数量等信息"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v("\n--line-numbers：查看规则时，显示规则的序号\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br")])]),n("ul",[n("li",[n("code",[t._v("iptables -L")]),t._v("      列出filter表的规则链的规则条目")]),t._v(" "),n("li",[n("code",[t._v("iptables -nvL")]),t._v("    列出filter表中的规则链")])]),t._v(" "),n("blockquote",[n("p",[t._v("设置默认规则")])]),t._v(" "),n("ul",[n("li",[n("code",[t._v("iptables -t nat -P OUTPUT ACCEPT")]),t._v("     给nat表中的OUTPUT链设置默认的ACCEPT规则")])]),t._v(" "),n("blockquote",[n("p",[t._v("规则的备份和还原")])]),t._v(" "),n("ul",[n("li",[t._v("导出: "),n("code",[t._v("iptables-save > /tmp/yutiy/iptables.txt")])]),t._v(" "),n("li",[t._v("还原: "),n("code",[t._v("iptables-restore < /tmp/yutiy/iptables.txt")])])]),t._v(" "),n("blockquote",[n("p",[t._v("规则永久生效")])]),t._v(" "),n("p",[t._v("iptables不是一个守护进程，我们修改只是当前的修改，重启服务或重启系统就会失效。要想使规则永久生效，需要保存规则："),n("code",[t._v("service  iptables  save")]),t._v("，使我们当前的配置保存到配置文件 "),n("code",[t._v("/etc/sysconfig/iptables")]),t._v(" 中，然后重启服务或者重启主机，使规则加载到内存，才能使配置永久生效。防火墙的运行需要建立在网络配置正常的前提下。")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("service iptables start/stop/restart")]),t._v("    开启/停止/重启 iptables服务")]),t._v(" "),n("li",[n("code",[t._v("chkconfig --level 5 iptables on/off")]),t._v("　　 使服务开启自启/不自启")])]),t._v(" "),n("h2",{attrs:{id:"使用示例"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#使用示例"}},[t._v("#")]),t._v(" 使用示例")]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("iptables -F                "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除 iptables 现有规则")]),t._v("\niptables -L "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-v"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("vv"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" -n"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看 iptables 规则")]),t._v("\niptables -A INPUT -i eth0 -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" -m state --state NEW,ESTABLISHED -j ACCEPT      "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在 INPUT 链尾添加一条规则")]),t._v("\niptables -I INPUT "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" -i eth0 -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" -m state --state NEW,ESTABLISHED -j ACCEPT    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 在 INPUT 链中插入为第二条规则")]),t._v("\niptables -D INPUT "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("       "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除 INPUT 链中第 2 条规则")]),t._v("\niptables -R INPUT "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" -i eth0 -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" -m state --state NEW,ESTABLISHED -j ACCEPT    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 替换修改第三条规则")]),t._v("\niptables -P INPUT DROP    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置 INPUT 链的默认策略为 DROP")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许远程主机进行 SSH 连接")]),t._v("\niptables -A INPUT -i eth0 -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUPUT -o eth0 -p tcp --sport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -m state --state ESTABLISHED -j ACCEPT\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许本地主机进行 SSH 连接")]),t._v("\niptables -A OUPUT -o eth0 -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A INPUT -i eth0 -p tcp --sport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -m state --state ESTABLISHED -j ACCEPT\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许 http 请求")]),t._v("\niptables -A INPUT -i eth0 -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" -m state --state NEW,ESTABLISHED -j ACCEPT\niptables -A OUPUT -o eth0 -p tcp --sport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" -m state --state ESTABLISHED -j ACCEPT\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 限制 ping 192.168.0.1 主机的数据包数，平均 2s 一个，最多不超过 3 个")]),t._v("\niptables -A INPUT -i eth0 -d "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".0.1 -p icmp --icmp-type "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" -m limit --limit "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/second --limit-burst "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" -j ACCEPT\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 限制 SSH 连接速率(默认策略是DROP)")]),t._v("\niptables -I INPUT "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v(" -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -d "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".0.1 -m state --state ESTABLISHED -j ACCEPT\niptables -I INPUT "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -d "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".0.1 -m limit --limit "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v("/minute --limit-burst "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),t._v(" -m state --state NEW -j ACCEPT\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 防止 syn 攻击(限制 syn 的请求速度)")]),t._v("\niptables -N syn-flood\niptables -A INPUT -p tcp --syn -j syn-flood\niptables -A syn-flood -m limit --limit "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/s --limit-burst "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("4")]),t._v(" -j ACCEPT\niptables -A syn-flood -j DROP\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 防止 syn 攻击(限制单个ip的最大syn连接数)")]),t._v("\niptables -A INPUT -i eth0 -p tcp --syn -m connlimit --connlimit-above "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("15")]),t._v(" -j DROP\niptables -I INPUT -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -m state --state NEW -m recent --set --name SSH   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 利用 recent 模块抵御 DOS 攻击")]),t._v("\niptables -I INPUT -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -m connlimit --connlimit-above "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" -j DROP          "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 单个 ip 最多连接 3 个会话")]),t._v("\niptables -I INPUT -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("22")]),t._v(" -m state NEW -m recent --update --seconds "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("300")]),t._v(" --hitcount "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),t._v(" --name SSH -j DROP "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 只要新的连接请求，就加入到 ssh 列表中，5分钟内尝试次数超过 3 次，就拒绝服务。5分钟后恢复")]),t._v("\n\niptables -I INPUT -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" -m connlimit --connlimit-above "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("30")]),t._v(" -j DROP         "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 防止单个IP访问量过大")]),t._v("\niptables -A OUTPUT -m state --state NEW -j DROP   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 防止反弹木马")]),t._v("\niptables -A INPUT -p icmp --icmp-type echo-request -m limit --limit "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("/m -j ACCEPT     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 防止 ping 攻击")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 允许可以ping别人，不允许别人ping自己")]),t._v("\niptables -A OUTPUT -p icmp --icmp-type "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("8")]),t._v(" -j ACCEPT\niptables -A INPUT -p icmp --icmp-type "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),t._v(" -j ACCEPT\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 127.0.0.1明确定义")]),t._v("\niptables -A INPUT -s "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1 -d "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1 -j ACCEPT\niptables -A OUTPUT -s "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1 -d "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("127.0")]),t._v(".0.1 -j ACCEPT\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# SNAT基于源地址转换。许多内网用户通过一个外网端口上网，将内网地址转换为一个外网IP，公用外网IP访问外网资源")]),t._v("\niptables -t nat -A POSTROUTING -s "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".10.1/24 -j SNAT --to-source "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.16")]),t._v(".100.1\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 当外网地址不固定时，将外网地址转化成 MASQUERADE(动态伪装), 其可以实现自动读取外网网卡获取的 IP 地址")]),t._v("\niptables -t nat -A POSTROUTING -s "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".10.1/24 -j MASQUERADE\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# DNAT 目标地址转换。")]),t._v("\niptables -t nat -A POSTROUTING -d "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("192.168")]),t._v(".10.1 -p tcp --dport "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("80")]),t._v(" -j DNAT --to-destination "),n("span",{pre:!0,attrs:{class:"token number"}},[t._v("172.16")]),t._v(".100.1:80\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br"),n("span",{staticClass:"line-number"},[t._v("41")]),n("br"),n("span",{staticClass:"line-number"},[t._v("42")]),n("br"),n("span",{staticClass:"line-number"},[t._v("43")]),n("br"),n("span",{staticClass:"line-number"},[t._v("44")]),n("br"),n("span",{staticClass:"line-number"},[t._v("45")]),n("br"),n("span",{staticClass:"line-number"},[t._v("46")]),n("br"),n("span",{staticClass:"line-number"},[t._v("47")]),n("br"),n("span",{staticClass:"line-number"},[t._v("48")]),n("br"),n("span",{staticClass:"line-number"},[t._v("49")]),n("br"),n("span",{staticClass:"line-number"},[t._v("50")]),n("br"),n("span",{staticClass:"line-number"},[t._v("51")]),n("br"),n("span",{staticClass:"line-number"},[t._v("52")]),n("br"),n("span",{staticClass:"line-number"},[t._v("53")]),n("br"),n("span",{staticClass:"line-number"},[t._v("54")]),n("br"),n("span",{staticClass:"line-number"},[t._v("55")]),n("br"),n("span",{staticClass:"line-number"},[t._v("56")]),n("br"),n("span",{staticClass:"line-number"},[t._v("57")]),n("br"),n("span",{staticClass:"line-number"},[t._v("58")]),n("br"),n("span",{staticClass:"line-number"},[t._v("59")]),n("br")])]),n("h1",{attrs:{id:"firewalld"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#firewalld"}},[t._v("#")]),t._v(" Firewalld")]),t._v(" "),n("blockquote",[n("p",[t._v("firewalld的配置模式")])]),t._v(" "),n("p",[t._v("firewalld的配置文件以xml格式为主（主配置文件firewalld.conf例外），他们有两个存储位置:")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("/etc/firewalld/services/")]),t._v(": 用户自定义配置文件")]),t._v(" "),n("li",[n("code",[t._v("/usr/lib/firewalld/services/")]),t._v(": 系统配置文件，预置文件，尽量不要修改")])]),t._v(" "),n("p",[n("img",{attrs:{src:a(601),alt:"iptables_firewalld区别"}})]),t._v(" "),n("blockquote",[n("p",[t._v("过滤规则集合: zone")])]),t._v(" "),n("ul",[n("li",[t._v("一个 zone 就是一套过滤规则，数据包必须经过某个 zone 才能入站或出站。不同 zone 中负责粒度粗细、安全强度度不尽相同。")]),t._v(" "),n("li",[t._v("每个 zone 单独对应一个 xml 文件，文件名为 "),n("code",[t._v("<zone名称>.xml")]),t._v("，然后在其中添加过滤规则即可")]),t._v(" "),n("li",[t._v("每个 zone 都有一个默认的处理行文，包括: default(缺省)、ACCEPT、REJECT、DROP")]),t._v(" "),n("li",[t._v("firewalld 提供了 9 个 zone:\n"),n("ul",[n("li",[n("strong",[t._v("drop")]),t._v(": 任何流入的包都被丢弃，不做任何响应。只允许流出的数据包")]),t._v(" "),n("li",[n("strong",[t._v("block")]),t._v(": 任何流入的包都被拒绝，返回icmp-host-prohibited报文(ipv4)或icmp6-adm-prohibited报文(ipv6)。只允许由该系统初始化的网络连接")]),t._v(" "),n("li",[n("strong",[t._v("public")]),t._v(": 默认的zone。部分公开，不信任网络中其他计算机，只放行特定服务")]),t._v(" "),n("li",[n("strong",[t._v("external")]),t._v(": 只允许选中的服务通过，用在路由器等启用伪装的外部网络。认为网路中其他计算器不可信")]),t._v(" "),n("li",[n("strong",[t._v("dmz")]),t._v(": 允许隔离区(dmz)中的电脑有限的被外界网络访问，只允许选中的服务通过")]),t._v(" "),n("li",[n("strong",[t._v("work")]),t._v(": 用在工作网络。你信任网络中的大多数计算机不会影响你的计算机，只允许选中的服务通过")]),t._v(" "),n("li",[n("strong",[t._v("home")]),t._v(": 用在家庭网络。信任网络中的大多数计算机，只允许选中的服务通过")]),t._v(" "),n("li",[n("strong",[t._v("internal")]),t._v(": 用在内部网络。信任网络中的大多数计算机，只允许选中的服务通过")]),t._v(" "),n("li",[n("strong",[t._v("trusted")]),t._v(": 允许所有网络连接，即使没有开放任何服务，那么使用此zone的流量照样通过（一路绿灯")])])])]),t._v(" "),n("blockquote",[n("p",[t._v("service")])]),t._v(" "),n("ul",[n("li",[t._v("一个 service 中可以配置特定的端口(将端口和service名字关联)。zone中加入 service 规则就等效于直接加入了 port 规则，但是使用 service 更容易理解和管理")]),t._v(" "),n("li",[t._v("定义 service 的方式，添加"),n("code",[t._v("<service名称>.xml文件，在其中加入要关联的端口即可")])])]),t._v(" "),n("p",[t._v("service示例: "),n("strong",[t._v("ssh.xml")])]),t._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="utf-8"?>')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("service")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("short")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("SSH"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("short")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("description")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Secure Shell (ssh)"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("description")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("tcp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("22"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("service")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br")])]),n("blockquote",[n("p",[t._v("过滤规则")])]),t._v(" "),n("ul",[n("li",[n("strong",[t._v("source")]),t._v(": 根据数据包源地址过滤，相同的source只能在一个zone中配置")]),t._v(" "),n("li",[n("strong",[t._v("interface")]),t._v(": 根据接收数据包的网卡过滤")]),t._v(" "),n("li",[n("strong",[t._v("service")]),t._v(": 根据服务名过滤（实际是查找服务关联的端口，根据端口过滤），一个service可以配置到多个zone中")]),t._v(" "),n("li",[n("strong",[t._v("port")]),t._v(": 根据端口过滤")]),t._v(" "),n("li",[n("strong",[t._v("imcp-block")]),t._v(": icmp报文过滤，可按照icmp类型设置")]),t._v(" "),n("li",[n("strong",[t._v("masquerade")]),t._v(": ip地址伪装，即将接收到的请求的源地址设置为转发请求网卡的地址（路由器的工作原理")]),t._v(" "),n("li",[n("strong",[t._v("orward-port")]),t._v(": 端口转发")]),t._v(" "),n("li",[n("strong",[t._v("rule")]),t._v(": 自定义规则，与itables配置接近。rule结合--timeout可以实现一些有用的功能，比如可以写个自动化脚本，发现异常连接时添加一条rule将相应地址drop掉，并使用--timeout设置时间段，过了之后再自动开放")])]),t._v(" "),n("blockquote",[n("p",[t._v("firewall-cmd")])]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[t._v("firewall-cmd --version\nfirewall-cmd --help\nfirewall-cmd --state                               "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看firewalld服务状态")]),t._v("\nfirewall-cmd --reload                              "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改配置文件后，动态加载，不会断开连接。")]),t._v("\nfirewall-cmd --complete-reload                     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 完全重新加载看，会断开连接。类似重启。")]),t._v("\nfirewall-cmd --panic-on/--panic-off/--query-panic  "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# panic模式开启/关闭/查询。panic模式会丢弃所有出入站的数据包，一段时间后所有连接都会超时中断。")]),t._v("\nfirewall-cmd --get-active-zones                    "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有绑定了source, interface和默认的zone，以及各个zone的生效条件。")]),t._v("\nfirewall-cmd --set-default-zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ZONE               "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 设置默认的zone，也可以修改firewalld.conf中的DefaultZone选项。")]),t._v("\n\nfirewall-cmd --zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("xxxx --list-all\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 反向查询：根据source或interface查询对应的zone")]),t._v("\nfirewall-cmd --get-zone-of-interface"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("interface\nfirewall-cmd --get-zone-of-source"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/mask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br")])]),n("p",[t._v("部分")]),t._v(" "),n("ul",[n("li",[n("code",[t._v("--zone=ZONE")]),t._v("        指定命令作用的zone，省缺的话命令作用于默认zone")]),t._v(" "),n("li",[n("code",[t._v("--permanent")]),t._v("        有此参数表示命令只是修改配置文件，需要reload才能生效；无此参数则立即在当前运行的实例中生效，不过不会改动配置文件，重启firewalld服务就没效果了。")]),t._v(" "),n("li",[n("code",[t._v("--timeout=seconds")]),t._v("  表示命令效果持续时间，到期后自动移除，不能和--permanent同时使用。例如因调试的需要加了某项配置，到时间自动移除了，不需要再回来手动删除。也可在出现异常情况时加入特定规则，过一段时间自动解除。")])]),t._v(" "),n("blockquote",[n("p",[t._v("zone文件配置规则")])]),t._v(" "),n("div",{staticClass:"language-xml line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-xml"}},[n("code",[n("span",{pre:!0,attrs:{class:"token prolog"}},[t._v('<?xml version="1.0" encoding="utf-8"?>')]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("zone")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("target")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("default"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--target属性为zone的默认处理行为，可选值：default(省缺),   ACCEPT,   %%REJECT%%,  DROP --\x3e")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("short")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("Demo"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("short")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("description")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("demo..."),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("description")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("source")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("address")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("address[/mask]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("interface")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ifcfg-em1"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("     "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--也可在网卡配置文件ifcfg-*中配置，只需要加入 ZONE=public --\x3e")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("service")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ssh"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("portid[-portid]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("tcp|udp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("icmp-block")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("echo-request"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("   "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("\x3c!--ping报文--\x3e")]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("masquerade")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("forward-port")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("portid[-portid]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("tcp|udp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("[to-port")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("portid[-portid]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("[to-addr")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ipv4address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n\n  "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("rule")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("[family")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("ipv4|ipv6"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n    [ "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("source")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("address")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("address[/mask]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("[invert")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("bool"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" ]\n    [ "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("destination")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("address")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("address[/mask]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("[invert")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("bool"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" ]\n    [\n      "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("service")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("string"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" |\n      "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("port")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("portid[-portid]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("tcp|udp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" |\n      "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("protocol")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("protocol"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" |\n      "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("icmp-block")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("name")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("icmptype"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" |\n      "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("masquerade")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" |\n      "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("forward-port")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("port")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("portid[-portid]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("protocol")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("tcp|udp"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("[to-port")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("portid[-portid]"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("[to-addr")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("address"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("\n    ]\n    [ "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("log")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("[prefix")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("prefixtext"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("[level")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("emerg|alert|crit|err|warn|notice|info|debug"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" ["),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("limit")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("rate/duration"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("] "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("log")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" ]\n    [ "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("audit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" ["),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("limit")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("value")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("rate/duration"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v("] "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("audit")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v(" ]\n    [ "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("accept")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" | "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("reject")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("[type")]),n("span",{pre:!0,attrs:{class:"token attr-value"}},[n("span",{pre:!0,attrs:{class:"token punctuation attr-equals"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')]),t._v("rejecttype"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v('"')])]),n("span",{pre:!0,attrs:{class:"token attr-name"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" | "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("<")]),t._v("drop")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("/>")])]),t._v(" ]\n    "),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("rule")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n"),n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token tag"}},[n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("</")]),t._v("zone")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")])]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br")])]),n("blockquote",[n("p",[t._v("使用firewall-cmd配置规则")])]),t._v(" "),n("div",{staticClass:"language-bash line-numbers-mode"},[n("pre",{pre:!0,attrs:{class:"language-bash"}},[n("code",[n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# zone的默认的行为")]),t._v("\nfirewall-cmd --permanent "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --get-target\nfirewall-cmd --permanent "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --set-target"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("target\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 配置source，相同的source只能在一个zone中配置,否则会提示Error: ZONE_CONFLICT 。")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --list-sources                        "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 显示绑定的source")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --query-source"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/mask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("          "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查询是否绑定了source")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --add-source"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/mask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("            "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 绑定source，如果已有绑定则取消。")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --change-source"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/mask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("                       "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 修改source，如果原来未绑定则添加绑定。")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --remove-source"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("source"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/mask"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("         "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 删除绑定")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# interface   如eth0, 也可以在网卡配置文件ifcfg-*中加入  ZONE=ZONE名")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --list-interfaces\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --add-interface"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("interface\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --change-interface"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("interface\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --query-interface"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("interface\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --remove-interface"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("interface\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# service")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --list-services\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --add-service"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("service "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--timeout"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("seconds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --remove-service"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("service\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --query-service"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("service\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# port")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --list-ports\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --add-port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("portid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-portid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("/protocol "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--timeout"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("seconds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --remove-port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("portid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-portid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("/protocol\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --query-port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("portid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-portid"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("/protocol\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# icmp-block, 默认允许所有ICMP通过")]),t._v("\nfirewall-cmd --get-icmptypes "),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 查看所有支持的ICMP类型：destination-unreachable echo-reply echo-request parameter-problemr-solicitation source-quench time-exceeded")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --list-icmp-blocks\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --add-icmp-block"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("icmptype "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--timeout"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("seconds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --remove-icmp-block"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("icmptype\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --query-icmp-block"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("icmptype\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# masquerade")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --add-masquerade "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--timeout"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("seconds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --remove-masquerade\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --query-masquerade\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# 端口转发")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --list-forward-ports\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --add-forward-port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":proto"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("PROTOCAL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(":toport"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(":toaddr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ADDRESS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/MASK"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--timeout"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token environment constant"}},[t._v("SECONDS")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --remove-forward-port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":proto"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("PROTOCAL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(":toport"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(":toaddr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ADDRESS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/MASK"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --query-forward-port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("port"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(":proto"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("PROTOCAL"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(":toport"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("-PORT"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v(":toaddr"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("ADDRESS"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("/MASK"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n\n"),n("span",{pre:!0,attrs:{class:"token comment"}},[t._v("# rule规则，  'rule'是将xml配置中的<和/>符号去掉后的字符串，如 'rule family=\"ipv4\" source address=\"1.2.3.4\" drop'")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --list-rich-rules\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --add-rich-rule"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rule'")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--timeout"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("seconds"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --remove-rich-rule"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rule'")]),t._v("\nfirewall-cmd "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--permanent"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" "),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("--zone"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v("zone"),n("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(" --query-rich-rule"),n("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),n("span",{pre:!0,attrs:{class:"token string"}},[t._v("'rule'")]),t._v("\n")])]),t._v(" "),n("div",{staticClass:"line-numbers-wrapper"},[n("span",{staticClass:"line-number"},[t._v("1")]),n("br"),n("span",{staticClass:"line-number"},[t._v("2")]),n("br"),n("span",{staticClass:"line-number"},[t._v("3")]),n("br"),n("span",{staticClass:"line-number"},[t._v("4")]),n("br"),n("span",{staticClass:"line-number"},[t._v("5")]),n("br"),n("span",{staticClass:"line-number"},[t._v("6")]),n("br"),n("span",{staticClass:"line-number"},[t._v("7")]),n("br"),n("span",{staticClass:"line-number"},[t._v("8")]),n("br"),n("span",{staticClass:"line-number"},[t._v("9")]),n("br"),n("span",{staticClass:"line-number"},[t._v("10")]),n("br"),n("span",{staticClass:"line-number"},[t._v("11")]),n("br"),n("span",{staticClass:"line-number"},[t._v("12")]),n("br"),n("span",{staticClass:"line-number"},[t._v("13")]),n("br"),n("span",{staticClass:"line-number"},[t._v("14")]),n("br"),n("span",{staticClass:"line-number"},[t._v("15")]),n("br"),n("span",{staticClass:"line-number"},[t._v("16")]),n("br"),n("span",{staticClass:"line-number"},[t._v("17")]),n("br"),n("span",{staticClass:"line-number"},[t._v("18")]),n("br"),n("span",{staticClass:"line-number"},[t._v("19")]),n("br"),n("span",{staticClass:"line-number"},[t._v("20")]),n("br"),n("span",{staticClass:"line-number"},[t._v("21")]),n("br"),n("span",{staticClass:"line-number"},[t._v("22")]),n("br"),n("span",{staticClass:"line-number"},[t._v("23")]),n("br"),n("span",{staticClass:"line-number"},[t._v("24")]),n("br"),n("span",{staticClass:"line-number"},[t._v("25")]),n("br"),n("span",{staticClass:"line-number"},[t._v("26")]),n("br"),n("span",{staticClass:"line-number"},[t._v("27")]),n("br"),n("span",{staticClass:"line-number"},[t._v("28")]),n("br"),n("span",{staticClass:"line-number"},[t._v("29")]),n("br"),n("span",{staticClass:"line-number"},[t._v("30")]),n("br"),n("span",{staticClass:"line-number"},[t._v("31")]),n("br"),n("span",{staticClass:"line-number"},[t._v("32")]),n("br"),n("span",{staticClass:"line-number"},[t._v("33")]),n("br"),n("span",{staticClass:"line-number"},[t._v("34")]),n("br"),n("span",{staticClass:"line-number"},[t._v("35")]),n("br"),n("span",{staticClass:"line-number"},[t._v("36")]),n("br"),n("span",{staticClass:"line-number"},[t._v("37")]),n("br"),n("span",{staticClass:"line-number"},[t._v("38")]),n("br"),n("span",{staticClass:"line-number"},[t._v("39")]),n("br"),n("span",{staticClass:"line-number"},[t._v("40")]),n("br"),n("span",{staticClass:"line-number"},[t._v("41")]),n("br"),n("span",{staticClass:"line-number"},[t._v("42")]),n("br"),n("span",{staticClass:"line-number"},[t._v("43")]),n("br"),n("span",{staticClass:"line-number"},[t._v("44")]),n("br"),n("span",{staticClass:"line-number"},[t._v("45")]),n("br"),n("span",{staticClass:"line-number"},[t._v("46")]),n("br"),n("span",{staticClass:"line-number"},[t._v("47")]),n("br"),n("span",{staticClass:"line-number"},[t._v("48")]),n("br"),n("span",{staticClass:"line-number"},[t._v("49")]),n("br"),n("span",{staticClass:"line-number"},[t._v("50")]),n("br"),n("span",{staticClass:"line-number"},[t._v("51")]),n("br"),n("span",{staticClass:"line-number"},[t._v("52")]),n("br"),n("span",{staticClass:"line-number"},[t._v("53")]),n("br")])]),n("blockquote",[n("p",[t._v("防火墙选择")])]),t._v(" "),n("ul",[n("li",[t._v("systemctl mask iptables.service   // 屏蔽iptables服务")]),t._v(" "),n("li",[t._v("systemctl start firewalld.service")]),t._v(" "),n("li",[t._v("systemctl enable firewalld.service")])]),t._v(" "),n("h1",{attrs:{id:"参考"}},[n("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[t._v("#")]),t._v(" 参考")]),t._v(" "),n("ul",[n("li",[n("a",{attrs:{href:"https://www.cnblogs.com/hftian/p/8280841.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux防火墙配置(iptables, firewalld)"),n("OutboundLink")],1)]),t._v(" "),n("li",[n("a",{attrs:{href:"https://blog.csdn.net/qq_36119192/article/details/82662026#iptables%E5%81%9A%E7%AB%AF%E5%8F%A3%E8%BD%AC%E5%8F%91",target:"_blank",rel:"noopener noreferrer"}},[t._v("Linux中的防火墙(Netfilter、Iptables、Firewalld)"),n("OutboundLink")],1)])])])}),[],!1,null,null,null);s.default=e.exports}}]);