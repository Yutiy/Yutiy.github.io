(window.webpackJsonp=window.webpackJsonp||[]).push([[99],{706:function(s,t,a){"use strict";a.r(t);var n=a(11),e=Object(n.a)({},(function(){var s=this,t=s.$createElement,a=s._self._c||t;return a("ContentSlotsDistributor",{attrs:{"slot-key":s.$parent.slotKey}},[a("h2",{attrs:{id:"nginx常用操作命令"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx常用操作命令"}},[s._v("#")]),s._v(" Nginx常用操作命令")]),s._v(" "),a("p",[s._v("Nginx的命令在终端中输入 "),a("code",[s._v("nginx -h")]),s._v(" 就可以看到完整命令，几个常用的命令如下:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("nginx -s reload             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 向主进程发送信号，重新加载配置文件，热重启")]),s._v("\nnginx -s reopen             "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 重启 Nginx")]),s._v("\nnginx -s stop               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 快速关闭 Nginx")]),s._v("\nnginx -s quit               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 等待工作进程处理完毕后关闭 Nginx")]),s._v("\nnginx -T                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 查看当前 Nginx 最终的配置")]),s._v("\nnginx -t -c "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("<")]),s._v("配置路径"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v(">")]),s._v("        "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 检查配置是否有问题，如果已经在配置目录，则不需要 -c")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br")])]),a("p",[s._v("当然 linux 系统中也可以运用 systemctl 来对 nginx 进行管理，可以查看上节提到的 "),a("RouterLink",{attrs:{to:"/docs/服务端/Nginx/1.Nginx基础.html"}},[s._v("Nginx基础")]),s._v("。")],1),s._v(" "),a("h2",{attrs:{id:"nginx配置语法"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#nginx配置语法"}},[s._v("#")]),s._v(" Nginx配置语法")]),s._v(" "),a("p",[s._v("Nginx 的主配置文件是 "),a("code",[s._v("/etc/nginx/nginx.conf")]),s._v(", 可以使用 "),a("code",[s._v("cat -n nginx.conf")]),s._v(" 来查看配置，其结构图如下:")]),s._v(" "),a("div",{staticClass:"language-bash line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-bash"}},[a("code",[s._v("main                      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 全局配置，对全局生效")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("—— events                "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置影响 nginx 服务器或与客户的网络连接")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("—— http                  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置代理，缓存，日志等绝大多数功能和第三方模块")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("—— upstream          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置后端服务器具体地址，负载均衡配置不可或缺的部分")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("—— server            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置虚拟主机的相关参数，一个 http 模块中可以有多个 server")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("—— server\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("—— location      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# server 可以包含多个 location(用于匹配uri)")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("—— location\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("—— "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("—— "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[s._v("|")]),s._v("—— "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("..")]),s._v(".\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br")])]),a("p",[s._v("一个 Nginx 配置文件的结构就像 "),a("code",[s._v("nginx.conf")]),s._v(" 显示的那样，配置文件的语法规则:")]),s._v(" "),a("ul",[a("li",[s._v("配置文件由指令与指令快构成")]),s._v(" "),a("li",[s._v("每条指令以 "),a("code",[s._v(";")]),s._v(" 分号结尾，指令与参数之间以空格富豪分隔")]),s._v(" "),a("li",[s._v("指令快以 "),a("code",[s._v("{}")]),s._v(" 打括号将多条指令组织在一起")]),s._v(" "),a("li",[a("code",[s._v("include")]),s._v(" 语句允许组合多个配置文件以提升可维护性")]),s._v(" "),a("li",[s._v("使用 "),a("code",[s._v("#")]),s._v(" 符号添加注释，提高可读性")]),s._v(" "),a("li",[s._v("使用 "),a("code",[s._v("$")]),s._v(" 使用变量")]),s._v(" "),a("li",[s._v("部分指令的参数支持正则表达式")])]),s._v(" "),a("h3",{attrs:{id:"典型配置"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#典型配置"}},[s._v("#")]),s._v(" 典型配置")]),s._v(" "),a("div",{staticClass:"language-nginx line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-nginx"}},[a("code",[a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("user")]),s._v(" nginx")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("                                   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 运行用户，默认即是nginx，可以不进行设置")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_processes")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("                           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Nginx 进程数，一般设置为和 CPU 核数一样")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_log")]),s._v(" /var/log/nginx/error.log warn")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Nginx 的错误日志存放目录")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("pid")]),s._v("       /var/run/nginx.pid")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("                 "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Nginx 服务启动时的 pid 存放位置")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("events")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("use")]),s._v(" epoll")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("                    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 使用epoll的I/O模型(如果你不知道Nginx该使用哪种轮询方法，会自动选择一个最适合你操作系统的)")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("worker_connections")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("1024")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 每个进程允许最大并发数")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n"),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("http")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 设置日志模式")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("log_format")]),s._v("  main  "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_addr")]),s._v(" - "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$remote_user")]),s._v(" ["),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$time_local]")]),s._v(' "'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$request")]),s._v("\" '")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'"),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$status")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$body_bytes_sent")]),s._v(' "'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_referer")]),s._v("\" '")]),s._v("\n                    "),a("span",{pre:!0,attrs:{class:"token string"}},[s._v("'\""),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_user_agent")]),s._v('" "'),a("span",{pre:!0,attrs:{class:"token variable"}},[s._v("$http_x_forwarded_for")]),s._v("\"'")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("access_log")]),s._v("  /var/log/nginx/access.log  main")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# Nginx访问日志存放位置")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("sendfile")]),s._v("            "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 开启高效传输模式")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tcp_nopush")]),s._v("          "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 减少网络报文段的数量")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("tcp_nodelay")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token boolean"}},[s._v("on")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("keepalive_timeout")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("65")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 保持连接的时间，也叫超时时间，单位秒")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("types_hash_max_size")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("2048")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v("             /etc/nginx/mime.types")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("      "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 文件扩展名与类型映射表")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("default_type")]),s._v("        application/octet-stream")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认文件类型")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("include")]),s._v(" /etc/nginx/conf.d/*.conf")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("               "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 加载子配置项")]),s._v("\n\n  "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server")])]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("listen")]),s._v("       "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("80")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("           "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置监听的端口")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("server_name")]),s._v("  localhost")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("    "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 配置的域名")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("location")]),s._v(" /")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("{")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("root")]),s._v("   /usr/share/nginx/html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 网站根目录")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("index")]),s._v("  index.html index.htm")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("   "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认首页文件")]),s._v("\n      "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("deny")]),s._v(" 172.168.22.11")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("            "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 禁止访问的ip地址，可以为all")]),s._v("\n      allow 172.168.33.44；          "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 允许访问的ip地址，可以为all")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_page")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("500")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("502")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("503")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("504")]),s._v(" /50x.html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("  "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 默认50x对应的访问页面")]),s._v("\n    "),a("span",{pre:!0,attrs:{class:"token directive"}},[a("span",{pre:!0,attrs:{class:"token keyword"}},[s._v("error_page")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("400")]),s._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[s._v("404")]),s._v(" error.html")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v(";")]),s._v("         "),a("span",{pre:!0,attrs:{class:"token comment"}},[s._v("# 同上")]),s._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[s._v("}")]),s._v("\n")])]),s._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[s._v("1")]),a("br"),a("span",{staticClass:"line-number"},[s._v("2")]),a("br"),a("span",{staticClass:"line-number"},[s._v("3")]),a("br"),a("span",{staticClass:"line-number"},[s._v("4")]),a("br"),a("span",{staticClass:"line-number"},[s._v("5")]),a("br"),a("span",{staticClass:"line-number"},[s._v("6")]),a("br"),a("span",{staticClass:"line-number"},[s._v("7")]),a("br"),a("span",{staticClass:"line-number"},[s._v("8")]),a("br"),a("span",{staticClass:"line-number"},[s._v("9")]),a("br"),a("span",{staticClass:"line-number"},[s._v("10")]),a("br"),a("span",{staticClass:"line-number"},[s._v("11")]),a("br"),a("span",{staticClass:"line-number"},[s._v("12")]),a("br"),a("span",{staticClass:"line-number"},[s._v("13")]),a("br"),a("span",{staticClass:"line-number"},[s._v("14")]),a("br"),a("span",{staticClass:"line-number"},[s._v("15")]),a("br"),a("span",{staticClass:"line-number"},[s._v("16")]),a("br"),a("span",{staticClass:"line-number"},[s._v("17")]),a("br"),a("span",{staticClass:"line-number"},[s._v("18")]),a("br"),a("span",{staticClass:"line-number"},[s._v("19")]),a("br"),a("span",{staticClass:"line-number"},[s._v("20")]),a("br"),a("span",{staticClass:"line-number"},[s._v("21")]),a("br"),a("span",{staticClass:"line-number"},[s._v("22")]),a("br"),a("span",{staticClass:"line-number"},[s._v("23")]),a("br"),a("span",{staticClass:"line-number"},[s._v("24")]),a("br"),a("span",{staticClass:"line-number"},[s._v("25")]),a("br"),a("span",{staticClass:"line-number"},[s._v("26")]),a("br"),a("span",{staticClass:"line-number"},[s._v("27")]),a("br"),a("span",{staticClass:"line-number"},[s._v("28")]),a("br"),a("span",{staticClass:"line-number"},[s._v("29")]),a("br"),a("span",{staticClass:"line-number"},[s._v("30")]),a("br"),a("span",{staticClass:"line-number"},[s._v("31")]),a("br"),a("span",{staticClass:"line-number"},[s._v("32")]),a("br"),a("span",{staticClass:"line-number"},[s._v("33")]),a("br"),a("span",{staticClass:"line-number"},[s._v("34")]),a("br"),a("span",{staticClass:"line-number"},[s._v("35")]),a("br"),a("span",{staticClass:"line-number"},[s._v("36")]),a("br"),a("span",{staticClass:"line-number"},[s._v("37")]),a("br"),a("span",{staticClass:"line-number"},[s._v("38")]),a("br"),a("span",{staticClass:"line-number"},[s._v("39")]),a("br"),a("span",{staticClass:"line-number"},[s._v("40")]),a("br"),a("span",{staticClass:"line-number"},[s._v("41")]),a("br"),a("span",{staticClass:"line-number"},[s._v("42")]),a("br"),a("span",{staticClass:"line-number"},[s._v("43")]),a("br"),a("span",{staticClass:"line-number"},[s._v("44")]),a("br")])]),a("p",[s._v("server 块可以包含多个 location 块，location 指令用于匹配 uri，语法如下 "),a("code",[s._v("location [= | ~ | ~* | ^~] uri {}")]),s._v(", 其中正则说明如下:")]),s._v(" "),a("ul",[a("li",[a("code",[s._v("=")]),s._v(" 精确匹配路径，用于不含正则表达式的 uri 前，如果匹配成功，则不再进行后续的查找")]),s._v(" "),a("li",[a("code",[s._v("^~")]),s._v(" 用于不含正则表达式的 uri 前，如果该符号后面的字符是最大匹配，则采用该规则，不再进行后续的查找")]),s._v(" "),a("li",[a("code",[s._v("~")]),s._v(" 表示用该符号后面的正则去匹配路径，区分大小写")]),s._v(" "),a("li",[a("code",[s._v("~*")]),s._v(" 表示用该符号后面的正则去匹配路径，不区分大小写。跟 "),a("code",[s._v("~")]),s._v(" 优先级都比较低，如有多个 location 的正则能匹配的话，则使用正则表达式最长的那个")])]),s._v(" "),a("p",[a("strong",[s._v("如果 uri 包含正则表达式，则必须要有 "),a("code",[s._v("~")]),s._v(" 或 "),a("code",[s._v("~*")]),s._v(" 标志")]),s._v("。")]),s._v(" "),a("h3",{attrs:{id:"全局变量"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#全局变量"}},[s._v("#")]),s._v(" 全局变量")]),s._v(" "),a("p",[s._v("Nginx 有一些常用的全局变量，可以在配置的任何位置使用，如下表所述:")]),s._v(" "),a("table",[a("thead",[a("tr",[a("th",[s._v("全局变量名")]),s._v(" "),a("th",[s._v("功能")])])]),s._v(" "),a("tbody",[a("tr",[a("td",[a("code",[s._v("$http")])]),s._v(" "),a("td",[s._v("请求信息中的 "),a("code",[s._v("Host")]),s._v("，如果请求中没有 "),a("code",[s._v("Host")]),s._v(" 行，则等于设置的服务器名，不包含端口")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$body_bytes_sent")])]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$request")])]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$request_method")])]),s._v(" "),a("td",[s._v("客户端请求类型，如"),a("code",[s._v("GET")]),s._v("、"),a("code",[s._v("POST")])])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$remote_addr")])]),s._v(" "),a("td",[s._v("客户端的 "),a("code",[s._v("IP")]),s._v(" 地址")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$remote_user")])]),s._v(" "),a("td")]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$reote_port")])]),s._v(" "),a("td",[s._v("客户端端口号")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$args")])]),s._v(" "),a("td",[s._v("请求中的参数 ｜")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$status")])]),s._v(" "),a("td",[s._v("｜")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$http_user_agent")])]),s._v(" "),a("td",[s._v("客户端 agent 信息")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$http_referer")])]),s._v(" "),a("td",[s._v("客户端 referer 信息")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$http_x_forwarded_for")])]),s._v(" "),a("td",[s._v("客户端 referer 信息")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$server_addr")])]),s._v(" "),a("td",[s._v("服务器地址")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$server_name")])]),s._v(" "),a("td",[s._v("服务器名称")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$server_port")])]),s._v(" "),a("td",[s._v("服务器端口号")])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$server_protocol")])]),s._v(" "),a("td",[s._v("请求使用的协议，如"),a("code",[s._v("HTTP/1.0")]),s._v("、"),a("code",[s._v("HTTP/1.1")])])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$scheme")])]),s._v(" "),a("td",[s._v("HTTP协议，如"),a("code",[s._v("http")]),s._v("、"),a("code",[s._v("https")])])]),s._v(" "),a("tr",[a("td",[a("code",[s._v("$time_local")])]),s._v(" "),a("td")])])]),s._v(" "),a("h2",{attrs:{id:"参考"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#参考"}},[s._v("#")]),s._v(" 参考")]),s._v(" "),a("p",[a("a",{attrs:{href:"https://juejin.im/post/5ea931866fb9a043815146fb#heading-12",target:"_blank",rel:"noopener noreferrer"}},[s._v("Nginx 从入门到实践，万字详解！"),a("OutboundLink")],1)])])}),[],!1,null,null,null);t.default=e.exports}}]);