---
title: '参数值传递'
date: 2020-03-26
permalink: 'js_deep/param_value_passing'
tag:
  - javascript深入系列
categories:
  - javascript深入系列
---

## 定义

在《JavaScript高级程序设计》第三版 4.1.3，讲到传递参数：

> ECMAScript中所有函数都是按值传递的

哪什么是按值传递呢?

> 值的是把函数外部的值复制给函数内部对象，就和把值从一个变量复制到另一个变量一样。

## 按值传递

举个🌰:

```js
var value = 1;
function foo(val) {
  val = 2;
  console.log(val);
}

foo(value);
console.log(value) // 1
```

很好理解，当传递 value 到函数 foo 中，相当于拷贝了一份 value，假设拷贝的这份叫 _value，函数中修改的都是 _value 的值，而不会影响原来的 value 值。

## 引用传递?

引用传递，就是传递对象的引用，函数内部对参数的任何改变都会影响该对象的值，因为两者引用的是同一个对象。

```js
var obj = {
  value: 1
};

function foo(o) {
  o.value = 2;
  console.log(o.value); // 2
}

foo(obj);
console.log(obj.value) // 2
```

貌似看起来不太对，不是说是按值传递嘛？这里怎么能够按照引用传递成功呢？这究竟算不算引用传递呢？

## 第三种传递方式

再看一个例子:

```js
var obj = {
  value: 1
};
function foo(o) {
  o = 2;
  console.log(o); // 2
}

foo(obj);
console.log(obj.value) // 1
```

如果 Javascript 是按照引用传递的话，那么外层的值也会被修改，这里怎么又没有被修改呢？所以不是真的引用传递吗？

这里就要讲到第三种传递方式，**共享传递**:

> 在传递对象的时候，传递的是对象的副本。

所以修改 o.value。可以通过引用找到原值，但是直接修改 o，就并不会修改原值。所以第二个和第三个都是共享传递。

## 总结

参数如果是基本类型，那么就是按值传递；参数如果是引用类型，那么就是共享传递。

但是因为拷贝副本也是一种值的拷贝，所以高程中也认为这是一种按值传递了。


## 参考

[Javascript深入之参数按值传递](https://github.com/mqyqingfeng/Blog/issues/10)
