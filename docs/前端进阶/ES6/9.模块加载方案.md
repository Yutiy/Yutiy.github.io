---
title: 'æ¨¡å—åŠ è½½æ–¹æ¡ˆ'
date: 2020-03-26
permalink: 'es6/module'
tag:
  - ES6
categories:
  - ES6
---

## require.js

åœ¨äº†è§£ AMD è§„èŒƒä¹‹å‰ï¼Œæˆ‘ä»¬å…ˆæ¥çœ‹çœ‹ require.js çš„ä½¿ç”¨æ–¹å¼ã€‚é¡¹ç›®ç›®å½•ä¸º:

```text
* project/
  * index.html
  * vender/
    * main.js
    * [require.js](https://github.com/requirejs/requirejs)
    * add.js
    * square.js
    * multiply.js
```

`index.html` çš„å†…å®¹å¦‚ä¸‹:

```html
<!DOCTYPE html>
<html>
  <head>
    <title>require.js</title>
  </head>
  <body>
    <h1>Content</h1>
    <script data-main="vender/main" src="vender/require.js"></script>
  </body>
</html>
```

`data-main="vender/main"` è¡¨ç¤ºä¸»æ¨¡å—æ˜¯ `vender` ä¸‹çš„ ``main.js`ã€‚

`main.js`çš„é…ç½®å¦‚ä¸‹:

```js
// main.js
require(['./add', './square'], function(addModule, squareModule) {
  console.log(addModule.add(1, 1));
  console.log(squareModule.square(3));
})
```

require çš„ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºä¾èµ–çš„æ¨¡å—çš„è·¯å¾„ï¼Œç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ­¤æ¨¡å—çš„å†…å®¹ã€‚å¯ä»¥çœ‹å‡º`ä¸»æ¨¡å—`ä¾èµ–ä¸`addæ¨¡å—`å’Œ`squareæ¨¡å—`ã€‚

çœ‹çœ‹ `addæ¨¡å—` å³ `add.js` çš„å†…å®¹:

```js
// add.js
define(function() {
  console.log('åŠ è½½äº† add æ¨¡å—');
  var add = function(x, y) {ã€€
    return x + y;
  };

  return {
    add: add
  };
});
```

requirejs ä¸ºå…¨å±€æ·»åŠ äº† define å‡½æ•°ï¼Œåªè¦æŒ‰ç…§è¿™ç§çº¦å®šçš„æ–¹å¼ä¹¦å†™è¿™ä¸ªæ¨¡å—å³å¯ã€‚é‚£å¦‚æœä¾èµ–çš„æ¨¡å—åˆä¾èµ–äº†å…¶ä»–æ¨¡å—å‘¢ï¼Ÿ

çœ‹çœ‹ä¸»æ¨¡å—ä¾èµ–çš„ `squareæ¨¡å—`ï¼Œå…¶ä½œç”¨æ˜¯æ±‚å‡ºä¸€ä¸ªæ•°å­—çš„å¹³æ–¹ï¼Œæ¯”å¦‚è¾“å…¥ 3 å°±è¿”å› 9ï¼Œè¯¥æ¨¡å—ä¾èµ–ä¸€ä¸ªä¹˜æ³•æ¨¡å—ï¼Œè¯¥ä¹˜æ³•æ¨¡å—å³ `multiply.js` çš„ä»£ç å¦‚ä¸‹ï¼š

```js
// multiply.js
define(function() {
  console.log('åŠ è½½äº† multiply æ¨¡å—')
  var multiply = function(x, y) {
    return x * y;
  };

  return {
    multiply: multiply
  };
})
```

è€Œ `squareæ¨¡å—` å°±è¦ç”¨åˆ° `multiplyæ¨¡å—`ï¼Œå…¶å®å†™æ³•è·Ÿ `main.js` æ·»åŠ ä¾èµ–æ¨¡å—ä¸€æ ·ï¼š

```js
// square.js
define(['./multiply'], function(multiplyModule) {
  console.log('åŠ è½½äº† square æ¨¡å—')
  return {
    square: function(num) {
      return multiplyModule.multiply(num, num)
    }
  };
});
```

require.js ä¼šè‡ªåŠ¨åˆ†æä¾èµ–å…³ç³»ï¼Œå°†éœ€è¦åŠ è½½çš„æ¨¡å—æ­£ç¡®åŠ è½½ã€‚å¦‚æœæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `index.html`ï¼Œæ‰“å°çš„é¡ºåºä¸ºï¼š

```text
åŠ è½½äº† add æ¨¡å—
åŠ è½½äº† multiply æ¨¡å—
åŠ è½½äº† square æ¨¡å—
2
9
```

## AMD

åœ¨ä¸Šä¸€èŠ‚ï¼Œæè¿°äº†ä¸€å¥è¯:

> requirejs ä¸ºå…¨å±€æ·»åŠ äº† define å‡½æ•°ï¼Œä½ åªè¦æŒ‰ç…§è¿™ç§çº¦å®šçš„æ–¹å¼ä¹¦å†™è¿™ä¸ªæ¨¡å—å³å¯

çº¦å®šä¹¦å†™çš„æ–¹å¼ä¾¿æ˜¯ [AMD(The Asynchronous Module Definition)](https://github.com/amdjs/amdjs-api/wiki/AMD-(%E4%B8%AD%E6%96%87%E7%89%88)),ã€‚

æ‰€ä»¥ï¼Œ**AMD å¯ä»¥è¯´æ˜¯æ˜¯ RequireJS åœ¨æ¨å¹¿è¿‡ç¨‹ä¸­å¯¹æ¨¡å—å®šä¹‰çš„è§„èŒƒåŒ–äº§å‡º**ã€‚

## sea.js

åœ¨å›½å†…ï¼Œç»å¸¸ä¸ AMD è¢«ä¸€èµ·æèµ·çš„è¿˜æœ‰ CMDï¼ŒCMD åˆæ˜¯ä»€ä¹ˆå‘¢ï¼Ÿæˆ‘ä»¬ä» sea.js çš„ä½¿ç”¨å¼€å§‹è¯´èµ·ã€‚é¡¹ç›®ç›®å½•ä¸º:

```text
* project/
  * index.html
  * vender/
    * main.js
    * [sea.js](https://github.com/seajs/seajs)
    * add.js
    * square.js
    * multiply.js
```

`index.html` çš„å†…å®¹å¦‚ä¸‹ï¼š

```html
<!DOCTYPE html>
<html>
<head>
  <title>sea.js</title>
</head>
<body>
  <h1>Content</h1>

  <script src="vender/sea.js"></script>
  <script>
    // åœ¨é¡µé¢ä¸­åŠ è½½ä¸»æ¨¡å—
    seajs.use("./vender/main");
  </script>
</body>

</html>
```

ä¾èµ–æ¨¡å—çš„å†…å®¹å¦‚ä¸‹:

```js
// main.js
define(function(require, exports, module) {
  var addModule = require('./add');
  console.log(addModule.add(1, 1))

  var squareModule = require('./square');
  console.log(squareModule.square(3))
});

// add.js
define(function(require, exports, module) {
  console.log('åŠ è½½äº† add æ¨¡å—')
  var add = function(x, y) {
    return x + y;
  };
  module.exports = {
    add: add
  };
});

// square.js
define(function(require, exports, module) {
  console.log('åŠ è½½äº† square æ¨¡å—')
  var multiplyModule = require('./multiply');
  module.exports = {
    square: function(num) {
      return multiplyModule.multiply(num, num)
    }
  };
});

// multiply.js
define(function(require, exports, module) {
  console.log('åŠ è½½äº† multiply æ¨¡å—')
  var multiply = function(x, y) {
    return x * y;
  };
  module.exports = {
    multiply: multiply
  };
});
```

è€Œå¦‚æœæˆ‘ä»¬åœ¨æµè§ˆå™¨ä¸­æ‰“å¼€ `index.html`ï¼Œæ‰“å°çš„é¡ºåºä¸ºï¼š

```text
åŠ è½½äº† add æ¨¡å—
2
åŠ è½½äº† square æ¨¡å—
åŠ è½½äº† multiply æ¨¡å—
9
```

## CMD

ä¸ AMD ä¸€æ ·ï¼ŒCMD å…¶å®å°±æ˜¯ SeaJS åœ¨æ¨å¹¿è¿‡ç¨‹ä¸­å¯¹æ¨¡å—å®šä¹‰çš„è§„èŒƒåŒ–äº§å‡ºã€‚

çœ‹ [CMD è§„èŒƒ](https://github.com/seajs/seajs/issues/242) çš„å†…å®¹ï¼Œä¸»è¦å†…å®¹å°±æ˜¯æè¿°è¯¥å¦‚ä½•å®šä¹‰æ¨¡å—ï¼Œå¦‚ä½•å¼•å…¥æ¨¡å—ï¼Œå¦‚ä½•å¯¼å‡ºæ¨¡å—ï¼Œåªè¦ä½ æŒ‰ç…§è¿™ä¸ªè§„èŒƒä¹¦å†™ä»£ç ï¼Œsea.js å°±èƒ½æ­£ç¡®çš„è¿›è¡Œè§£æã€‚

## AMD ä¸ CMD çš„åŒºåˆ«

ä» sea.js å’Œ require.js çš„ä¾‹å­å¯ä»¥çœ‹å‡ºï¼š

1. CMD æ¨å´‡**ä¾èµ–å°±è¿‘**ï¼ŒAMD æ¨å´‡**ä¾èµ–å‰ç½®**
2. å¯¹äºä¾èµ–çš„æ¨¡å—ï¼ŒAMD æ˜¯**æå‰æ‰§è¡Œ**ï¼ŒCMD æ˜¯**å»¶è¿Ÿæ‰§è¡Œ**

## CommonJS

AMD å’Œ CMD éƒ½æ˜¯ç”¨äºæµè§ˆå™¨ç«¯çš„æ¨¡å—è§„èŒƒï¼Œè€Œåœ¨æœåŠ¡å™¨ç«¯æ¯”å¦‚ nodeï¼Œé‡‡ç”¨çš„åˆ™æ˜¯ CommonJS è§„èŒƒã€‚

å°†ä¹‹å‰çš„ä¾‹å­æ”¹æˆ CommonJs è§„èŒƒ:

```js
// main.js
var add = require('./add.js');
console.log(add.add(1, 1))

var square = require('./square.js');
console.log(square.square(3));

// add.js
console.log('åŠ è½½äº† add æ¨¡å—')
var add = function(x, y) {ã€€
  return x + y;
};

module.exports.add = add;

// multiply.js
console.log('åŠ è½½äº† multiply æ¨¡å—')
var multiply = function(x, y) {
  return x * y;
};

module.exports.multiply = multiply;

// square.js
console.log('åŠ è½½äº† square æ¨¡å—')
var multiply = require('./multiply.js');
var square = function(num) {
  return multiply.multiply(num, num);
};

module.exports.square = square;
```

å¦‚æœæˆ‘ä»¬æ‰§è¡Œ `node main.js`ï¼Œæ‰“å°çš„é¡ºåºä¸ºï¼š

```text
åŠ è½½äº† add æ¨¡å—
2
åŠ è½½äº† square æ¨¡å—
åŠ è½½äº† multiply æ¨¡å—
9
```

å¯ä»¥çœ‹å‡ºï¼Œç»“æœä¸ sea.js æ‰§è¡Œç»“æœä¸€è‡´ï¼Œä¹Ÿæ˜¯åœ¨ require çš„æ—¶å€™åŠ è½½æ¨¡å—æ–‡ä»¶ï¼ŒåŠ è½½å®Œå†æ¥ç€æ‰§è¡Œã€‚

## CommonJS ä¸ AMD

- CommonJS è§„èŒƒåŠ è½½æ¨¡å—æ˜¯åŒæ­¥çš„ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œåªæœ‰åŠ è½½å®Œæˆï¼Œæ‰èƒ½æ‰§è¡Œåé¢çš„æ“ä½œã€‚
- AMDè§„èŒƒåˆ™æ˜¯éåŒæ­¥åŠ è½½æ¨¡å—ï¼Œå…è®¸æŒ‡å®šå›è°ƒå‡½æ•°ã€‚
- ç”±äº Node.js ä¸»è¦ç”¨äºæœåŠ¡å™¨ç¼–ç¨‹ï¼Œæ¨¡å—æ–‡ä»¶ä¸€èˆ¬éƒ½å·²ç»å­˜åœ¨äºæœ¬åœ°ç¡¬ç›˜ï¼Œæ‰€ä»¥åŠ è½½èµ·æ¥æ¯”è¾ƒå¿«ï¼Œä¸ç”¨è€ƒè™‘éåŒæ­¥åŠ è½½çš„æ–¹å¼ï¼Œæ‰€ä»¥ CommonJS è§„èŒƒæ¯”è¾ƒé€‚ç”¨ã€‚
- ä½†æ˜¯ï¼Œå¦‚æœæ˜¯æµè§ˆå™¨ç¯å¢ƒï¼Œè¦ä»æœåŠ¡å™¨ç«¯åŠ è½½æ¨¡å—ï¼Œè¿™æ—¶å°±å¿…é¡»é‡‡ç”¨éåŒæ­¥æ¨¡å¼ï¼Œå› æ­¤æµè§ˆå™¨ç«¯ä¸€èˆ¬é‡‡ç”¨ AMD è§„èŒƒã€‚

## ES6

ECMAScript2015 è§„å®šäº†æ–°çš„æ¨¡å—åŠ è½½æ–¹æ¡ˆã€‚

å°†ä¸Šé¢ä¾‹å­æ”¹æˆ ES6 è§„èŒƒ:

```html
<!DOCTYPE html>
<html>
  <head>
    <title>ES6</title>
  </head>
  <body>
    <h1>Content</h1>
    <!-- æµè§ˆå™¨åŠ è½½ ES6 æ¨¡å—ï¼Œä¹Ÿä½¿ç”¨ <script> æ ‡ç­¾ï¼Œä½†æ˜¯è¦åŠ å…¥ type="module" å±æ€§ -->
    <script src="vender/main.js" type="module"></script>
  </body>
</html>
```

```js
// main.js
import {add} from './add.js';
console.log(add(1, 1))

import {square} from './square.js';
console.log(square(3));

// add.js
console.log('åŠ è½½äº† add æ¨¡å—')
var add = function(x, y) {
  return x + y;
};

export { add };

// multiply.js
console.log('åŠ è½½äº† multiply æ¨¡å—')
var multiply = function(x, y) {
  return x * y;
};

export { multiply };

// square.js
console.log('åŠ è½½äº† square æ¨¡å—')
import {multiply} from './multiply.js';

var square = function(num) {
  return multiply(num, num);
};

export { square };
```

å€¼å¾—æ³¨æ„çš„ï¼Œåœ¨ Chrome ä¸­ï¼Œå¦‚æœç›´æ¥æ‰“å¼€ï¼Œä¼šæŠ¥è·¨åŸŸé”™è¯¯ï¼Œå¿…é¡»å¼€å¯æœåŠ¡å™¨ï¼Œä¿è¯æ–‡ä»¶åŒæºæ‰å¯ä»¥æœ‰æ•ˆæœã€‚

å¯ä»¥å®‰è£… `server` åŒ…ï¼Œæ‰§è¡Œæ‰“å°çš„é¡ºåºå¦‚ä¸‹:

```text
åŠ è½½äº† add æ¨¡å—
åŠ è½½äº† multiply æ¨¡å—
åŠ è½½äº† square æ¨¡å—
2
9
```

å¯ä»¥çœ‹å‡ºï¼Œè·Ÿ require.js çš„æ‰§è¡Œç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä¹Ÿå°±æ˜¯å°†éœ€è¦ä½¿ç”¨çš„æ¨¡å—å…ˆåŠ è½½å®Œå†æ‰§è¡Œä»£ç ã€‚

## ES6ä¸CommonJs

å®ƒä»¬ä¸¤ä¸ªæœ‰é‡å¤§å·®å¼‚:

- CommonJS æ¨¡å—è¾“å‡ºçš„æ˜¯ä¸€ä¸ªå€¼çš„æ‹·è´ï¼ˆä¸€æ—¦è¾“å‡ºä¸€ä¸ªå€¼ï¼Œæ¨¡å—å†…éƒ¨çš„å˜åŒ–å°±å½±å“ä¸åˆ°è¿™ä¸ªå€¼ã€‚ï¼‰ï¼ŒES6 æ¨¡å—è¾“å‡ºçš„æ˜¯å€¼çš„å¼•ç”¨ã€‚
- CommonJS æ¨¡å—æ˜¯è¿è¡Œæ—¶åŠ è½½ï¼ŒES6 æ¨¡å—æ˜¯ç¼–è¯‘æ—¶è¾“å‡ºæ¥å£ã€‚

ä¸¾ä¸ªğŸŒ° :

```js
// è¾“å‡ºæ¨¡å— counter.js
var counter = 3;
function incCounter() {
  counter++;
}
module.exports = {
  counter: counter,
  incCounter: incCounter,
};

// å¼•å…¥æ¨¡å— main.js
var mod = require('./counter');

console.log(mod.counter);  // 3
mod.incCounter();
console.log(mod.counter); // 3
```

counter.js æ¨¡å—åŠ è½½ä»¥åï¼Œå®ƒçš„å†…éƒ¨å˜åŒ–å°±å½±å“ä¸åˆ°è¾“å‡ºçš„ mod.counter äº†ã€‚è¿™æ˜¯å› ä¸º mod.counter æ˜¯ä¸€ä¸ªåŸå§‹ç±»å‹çš„å€¼ï¼Œä¼šè¢«ç¼“å­˜ã€‚

ä½†æ˜¯å¦‚æœä¿®æ”¹ counter ä¸ºä¸€ä¸ªå¼•ç”¨ç±»å‹çš„è¯:

```js
// è¾“å‡ºæ¨¡å— counter.js
var counter = {
  value: 3
};

function incCounter() {
  counter.value++;
}
module.exports = {
  counter: counter,
  incCounter: incCounter,
};

// å¼•å…¥æ¨¡å— main.js
var mod = require('./counter.js');

console.log(mod.counter.value); // 3
mod.incCounter();
console.log(mod.counter.value); // 4
```

value æ˜¯ä¼šå‘ç”Ÿæ”¹å˜çš„ã€‚ä¸è¿‡ä¹Ÿå¯ä»¥è¯´è¿™æ˜¯ "å€¼çš„æ‹·è´"ï¼Œåªæ˜¯å¯¹äºå¼•ç”¨ç±»å‹è€Œè¨€ï¼Œå€¼æŒ‡çš„å…¶å®æ˜¯å¼•ç”¨ã€‚

è€Œå¦‚æœå°†è¿™ä¸ªä¾‹å­æ”¹æˆ ES6:

```js
// counter.js
export let counter = 3;
export function incCounter() {
  counter++;
}

// main.js
import { counter, incCounter } from './counter';
console.log(counter); // 3
incCounter();
console.log(counter); // 4
```

è¿™æ˜¯å› ä¸º:

> ES6 æ¨¡å—çš„è¿è¡Œæœºåˆ¶ä¸ CommonJS ä¸ä¸€æ ·ã€‚JS å¼•æ“å¯¹è„šæœ¬é™æ€åˆ†æçš„æ—¶å€™ï¼Œé‡åˆ°æ¨¡å—åŠ è½½å‘½ä»¤ importï¼Œå°±ä¼šç”Ÿæˆä¸€ä¸ªåªè¯»å¼•ç”¨ã€‚ç­‰åˆ°è„šæœ¬çœŸæ­£æ‰§è¡Œæ—¶ï¼Œå†æ ¹æ®è¿™ä¸ªåªè¯»å¼•ç”¨ï¼Œåˆ°è¢«åŠ è½½çš„é‚£ä¸ªæ¨¡å—é‡Œé¢å»å–å€¼ã€‚æ¢å¥è¯è¯´ï¼ŒES6 çš„ import æœ‰ç‚¹åƒ Unix ç³»ç»Ÿçš„â€œç¬¦å·è¿æ¥â€ï¼ŒåŸå§‹å€¼å˜äº†ï¼Œimport åŠ è½½çš„å€¼ä¹Ÿä¼šè·Ÿç€å˜ã€‚å› æ­¤ï¼ŒES6 æ¨¡å—æ˜¯åŠ¨æ€å¼•ç”¨ï¼Œå¹¶ä¸”ä¸ä¼šç¼“å­˜å€¼ï¼Œæ¨¡å—é‡Œé¢çš„å˜é‡ç»‘å®šå…¶æ‰€åœ¨çš„æ¨¡å—ã€‚

## Babel

é‰´äºæµè§ˆå™¨æ”¯æŒåº¦çš„é—®é¢˜ï¼Œå¦‚æœè¦ä½¿ç”¨ ES6 çš„è¯­æ³•ï¼Œä¸€èˆ¬éƒ½ä¼šå€ŸåŠ© Babelï¼Œå¯å¯¹äº import å’Œ export è€Œè¨€ï¼Œåªå€ŸåŠ© Babel å°±å¯ä»¥å—ï¼Ÿ

çœ‹çœ‹ Babel æ˜¯æ€ä¹ˆç¼–è¯‘ import å’Œ export è¯­æ³•çš„ã€‚

```js
// ES6
var firstName = 'Michael';
var lastName = 'Jackson';
var year = 1958;

export { firstName, lastName, year };

// Babel ç¼–è¯‘å
'use strict';

Object.defineProperty(exports, "__esModule", {
  value: true
});
var firstName = 'Michael';
var lastName = 'Jackson';
var year = 1958;

exports.firstName = firstName;
exports.lastName = lastName;
exports.year = year;
```

æ˜¯ä¸æ˜¯æ„Ÿè§‰æœ‰é‚£ä¹ˆä¸€ç‚¹å¥‡æ€ªï¼Ÿç¼–è¯‘åçš„è¯­æ³•æ›´åƒæ˜¯ CommonJS è§„èŒƒï¼Œå†çœ‹ import çš„ç¼–è¯‘ç»“æœï¼š

```js
// ES6
import {firstName, lastName, year} from './profile';

// Babel ç¼–è¯‘å
'use strict';

var _profile = require('./profile');
```

ä½ ä¼šå‘ç° Babel åªæ˜¯æŠŠ ES6 æ¨¡å—è¯­æ³•è½¬ä¸º CommonJS æ¨¡å—è¯­æ³•ï¼Œç„¶è€Œæµè§ˆå™¨æ˜¯ä¸æ”¯æŒè¿™ç§æ¨¡å—è¯­æ³•çš„ï¼Œæ‰€ä»¥ç›´æ¥è·‘åœ¨æµè§ˆå™¨ä¼šæŠ¥é”™çš„ï¼Œå¦‚æœæƒ³è¦åœ¨æµè§ˆå™¨ä¸­è¿è¡Œï¼Œè¿˜æ˜¯éœ€è¦ä½¿ç”¨æ‰“åŒ…å·¥å…·å°†ä»£ç æ‰“åŒ…ã€‚

## Webpack

Babel å°† ES6 æ¨¡å—è½¬ä¸º CommonJS åï¼Œ webpack åˆæ˜¯æ€ä¹ˆåšçš„æ‰“åŒ…çš„å‘¢ï¼Ÿå®ƒè¯¥å¦‚ä½•å°†è¿™äº›æ–‡ä»¶æ‰“åŒ…åœ¨ä¸€èµ·ï¼Œä»è€Œèƒ½ä¿è¯æ­£ç¡®çš„å¤„ç†ä¾èµ–ï¼Œä»¥åŠèƒ½åœ¨æµè§ˆå™¨ä¸­è¿è¡Œå‘¢ï¼Ÿ

é¦–å…ˆä¸ºä»€ä¹ˆæµè§ˆå™¨ä¸­ä¸æ”¯æŒ CommonJS è¯­æ³•å‘¢ï¼Ÿ

è¿™æ˜¯å› ä¸ºæµè§ˆå™¨ç¯å¢ƒä¸­å¹¶æ²¡æœ‰ moduleã€ exportsã€ require ç­‰ç¯å¢ƒå˜é‡ã€‚ä¹Ÿå°±æ˜¯è¯´ webpack æ‰“åŒ…åçš„æ–‡ä»¶ä¹‹æ‰€ä»¥åœ¨æµè§ˆå™¨ä¸­èƒ½è¿è¡Œï¼Œå°±æ˜¯é æ¨¡æ‹Ÿäº†è¿™äº›å˜é‡çš„è¡Œä¸ºã€‚

é‚£æ€ä¹ˆæ¨¡æ‹Ÿå‘¢ï¼Ÿä»¥ CommonJS é¡¹ç›®ä¸­çš„ square.js ä¸ºä¾‹ï¼Œå®ƒä¾èµ–äº† multiply æ¨¡å—ï¼š

```js
console.log('åŠ è½½äº† square æ¨¡å—')
var multiply = require('./multiply.js');
var square = function(num) {
  return multiply.multiply(num, num);
};

module.exports.square = square;
```

webpack ä¼šå°†å…¶åŒ…è£¹ä¸€å±‚ï¼Œæ³¨å…¥è¿™äº›å˜é‡ï¼š

```js
function(module, exports, require) {
  console.log('åŠ è½½äº† square æ¨¡å—');
  var multiply = require("./multiply");
  module.exports = {
    square: function(num) {
      return multiply.multiply(num, num);
    }
  };
}
```

é‚£ webpack åˆä¼šå°† CommonJS é¡¹ç›®çš„ä»£ç æ‰“åŒ…æˆä»€ä¹ˆæ ·å‘¢ï¼Ÿæˆ‘å†™äº†ä¸€ä¸ªç²¾ç®€çš„ä¾‹å­ï¼Œä½ å¯ä»¥ç›´æ¥å¤åˆ¶åˆ°æµè§ˆå™¨ä¸­æŸ¥çœ‹æ•ˆæœï¼š

```js
// è‡ªæ‰§è¡Œå‡½æ•°
(function(modules) {
  // ç”¨äºå‚¨å­˜å·²ç»åŠ è½½è¿‡çš„æ¨¡å—
  var installedModules = {};
  function require(moduleName) {
    if (installedModules[moduleName]) {
      return installedModules[moduleName].exports;
    }

    var module = installedModules[moduleName] = {
      exports: {}
    };

    modules[moduleName](module, module.exports, require);
    return module.exports;
  }

  // åŠ è½½ä¸»æ¨¡å—
  return require("main");
})({
  "main": function(module, exports, require) {
    var addModule = require("./add");
    console.log(addModule.add(1, 1))

    var squareModule = require("./square");
    console.log(squareModule.square(3));
  },
  "./add": function(module, exports, require) {
    console.log('åŠ è½½äº† add æ¨¡å—');
    module.exports = {
      add: function(x, y) {
        return x + y;
      }
    };
  },
  "./square": function(module, exports, require) {
    console.log('åŠ è½½äº† square æ¨¡å—');
    var multiply = require("./multiply");
    module.exports = {
      square: function(num) {
        return multiply.multiply(num, num);
      }
    };
  },
  "./multiply": function(module, exports, require) {
    console.log('åŠ è½½äº† multiply æ¨¡å—');
    module.exports = {
      multiply: function(x, y) {
        return x * y;
      }
    };
  }
})
```

æœ€ç»ˆçš„æ‰§è¡Œç»“æœä¸ºï¼š

```text
åŠ è½½äº† add æ¨¡å—
2
åŠ è½½äº† square æ¨¡å—
åŠ è½½äº† multiply æ¨¡å—
9
```
